# nishikawa_td_src



## 〜注意点〜
・RQの番号は2019年夏あたりにRQを設定した時の番号のため現在のRQの番号とは合わないことが多いと思います．  
RQ0->変更にSATDが含まれるレビューの割合（現在のRQ1）  
RQ1->SATDを追加した開発者は，コードレビュー依頼時に自分でSATDがある旨を宣言しているのか？（現在没）  
RQ2->SATDが含まれるコードレビューの不採録率，修正回数（現在のRQ2）  
RQ3->コードレビュー中に削除されるSATDの数・割合（現在のRQ3の半分）  
RQ4->コードレビュー中に追加されるSATDの数・割合（現在のRQ3のもう半分）  
RQ5->リプリケーション（現在のRQ4）  
  
※（）内は2020/8/20時点でのRQ番号  
  

＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿


## 〜最重要項目〜

・各現RQの結果が載ってるとこ  
RQ1(変更にSATDが含まれるレビューの割合)->RQ0fullmerge.shを実行するとターミナル上に出力される  
RQ2(不採録率，修正回数)->./RQanswers/RQ2_fullmerge_(proj_name).csv  
            ./RQanswers/RQ2-2_fullmerge_(proj_name).csv  
RQ3(コードレビュー中に削除・追加されるSATDの数・割合)->./RQanswers/comment_shuffule_RQ34all.xlsx  
RQ4(リプリケーション)->./RQanswers/RQ5_openstack.csv , ./RQanswers/RQ5_qt.csv  


・各種RQの実行ファイル順序  
RQ1: msrX_RQ0.shまたはmsrX_RQpart_retry.sh->msrX_RQ0merge.sh->AWS上の実行結果をDL->RQ0fullmerge.sh  
（レビューデータを取り直したい，上書きしたいときはRQ0.sh, そうでない場合はRQ0part_retry.shを使用）  
RQ2: msrX_RQ2.sh->msrX_RQ2checker.sh->AWS上の実行結果をDL->RQ2fullmerge.sh  
RQ3: msrX_RQ34.sh->msrX_RQ34merge.sh->AWS上の実行結果をDL->RQ34fullmerge2.sh->RQ34fullshuffle.sh  
RQ4: msrX_RQ5.sh->AWS上の実行結果をDL->RQ5fullmerge.sh  
  
※一部AWS上で分散実行している物あり．必要に応じて実行結果をこっちに転送しなければならないものもある  
  XはこのPC上で実行する場合は0, AWS上で実行する場合は対応する1~4のいずれかの番号が入る．  
  詳細は後述の，〜サブプロジェクトの分担〜を参照．  
  
  
〜AWS上のデータの扱い方〜  
基本的にsrcファイルはそのままAWSへ転送，実行用シェルファイルはawsフォルダ内にあるものを転送  
  

＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿



## 〜フォルダについて〜  
・result  
名前が紛らわしい．  
抽出結果という意味でresultという名前を入れただけなので実験結果という意味は含まれてないです．  
APIから抽出したデータの保存場所．  
中はresult/(proj_name)/番号...と続いてる．  
(proj_name=メインプトジェクトの名前．番号はレビュー番号．何段階かに分かれてる）  
  
・src  
各種ソースコード．  
  
・RQ5data  
なんだったけこれ．最後のRQの途中ファイルを保管してた気がする．  
  
・temp  
直接はいじらない．一時保存したいデータがある時に使う．  
一応中のproj_info_(number).jsonは  
どの番号がどのサブプロジェクトのものかの情報を保存してるけど多分もう放置でOK  
  
・RQanswers  
RQそれぞれの最終的な結果を保存する．  
最終的な結果ってのはAWSとかで分散させてたデータを統合した結果ということ．  
  
・dict  
中には(sub_name).jsonって名前のがたくさんある．  
これらはそのサブプロジェクトについてのレビューであるレビュー番号を配列式で保存している．  
  
・DS  
RQ5（maldonadoのレプリケーション）で使う．ちなみにDSはDataSetの略のつもりです．  
GitHubの方からクローンしてきたプロジェクトをここに保存する．  
  
・DS_copy  
DSのデータがなんか破損した時はここからコピペし直す．  
ダウンロード時のプロジェクトの状態を保存するためのフォルダ．  
  
・config  
remove_detect.plを起動する時に使う．  
  
・backup  
もしもの時のために古いデータをテキトーに保存してる．ぶっちゃけ使いません．  
  
・yobi  
上と同じく．  
  
・aws  
AWS上に持っていくシェルファイルをまとめている．msrXのXはAWS上での番号と同じ．  
AWSで起動を行うシェルファイルはmsrごとにここにあるものを使う．  
ちなみに番号ごとに対象プロジェクトが違う．  
  
・logs  
AWS上で何かあった時にログをこっちに持っていきたい場合にここに突っ込む．手動で．  
  
・csv  
RQ3,4の結果をこっちに突っ込んだりしてた．  
最終更新が古いので今は使ってないかも．  
  
・data, data_msr1~4  
1~4はAWS上で割り振ってある番号が該当する．  
それぞれ分散させて実験した結果はここに保存させる．  
後の実験に必要だったりする（例：RQ34の情報は一部RQ5にも使う）．  
基本的には直接触れる必要はないはず．  
  
＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿
  
## 〜サブプロジェクトの分担〜
  
・このmac上  
openstack->glance, nova, swift  
qt->qtquickcontrols, qtquickcontrols, qtenginio, qtrepotools, qtx11extras, qtmacextras,
qtsvg,  
qtbaseの一部  
  
・msr(AWS)  
openstack->cinder, neutron  
qt->qtmultimedia, qtandroidextras, qttranslations, qtdoc, qtwinextras, qtquick1, qtlocation,  
qtbaseの一部  
  
・msr2(AWS)  
qt->qtactiveqt, qtwebsockets, qttools, qtxmlpatterns, qtqa, qtsensors, qtimageformats,  
qtwebchannel, qtserialport, qtconnectivity, qtgraphicaleffects, qtwebkit-examples,
qtwebkit, qtscript, qtdeclarative  
qtbaseの一部  
  
・msr3(AWS)  
qtbaseの一部  
  
・msr4(AWS)  
qtbaseの一部  
  
  
※qtbaseについて  
とにかくこいつのみ量が破格の大きさなので，  
RQ0(現RQ1)はレビュー番号で区切ってAWS含む複数のCPU上で動かしている．  
具体的な分担は．  
このmac->1-30000  
msr->30001-60000  
msr2->60001-120000  
msr3->120001-195000  
msr4->195001-263350  
となっており，シェルファイルのnohupコマンドを用いて15000区切りで並列実行させている．  
（例えばmsr2なら60001-75000, 75001-90000, 90001-105000, 105001-120000の
　４パートに分けて並列実行．）  
  
AWS上にあるサブプロジェクトはそれぞれのRQのmerge.sh（サブプロジェクトごとの結果の算出）までは  
AWS上で動作させるが，fullmerge.sh（メインプロジェクトごとの結果の算出）を行う前には  
それぞれのAWS上のdataディレクトリのファイルを丸ごとこちらのdata_msrXへ持ってくる必要がある．  
  
＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿
  
## 〜シェルファイル関連〜
  
基本ここからsrcのファイルを実行させる．  
  
・RQ0.sh  
引数：メインプロジェクト名 サブプロジェクト名 始点レビュー番号 終点レビュー番号 (＋途中から始める時は5つ目の引数にそのレビュー番号も)  
サブプロジェクト単位で現RQ1の調査をする．  
レビューデータが既にある場合もAPIからのデータを取得して上書きするので遅い．  
  
・msr0_RQ0.sh  
引数：なし  
前提：RQ0.sh同様  
このpc上で担当するサブプロジェクト全てについてRQ0.shを一気にやってくれる．  
...が，現RQ1はかなり時間がかかる上にPCが重くなる可能性が高く，  
wi-fi接続が切れるとAPIからデータが得られなくなるので基本オススメできない．  
手間ではあるがサブプロジェクトごとにRQ0.shを実行した方が確実．  
AWS上で行うmsr1~4_RQ0.shの方は接続が切れるなどの可能性は低いのでその点の心配はない．  
  
・RQ0part_retry.sh  
引数：RQ0.shと同様  
基本は上記のRQ0.shと同様．  
ただしAPIへのアクセスは省略するので既にレビューデータを保存しているならこちらを実行した方が早い．  
  
・msr0_RQ0retry.sh  
引数：なし  
前提：RQ0part_retry.sh同様  
このpc上で担当するサブプロジェクト全てについてRQ0part_retry.shを一気にやってくれる．  
msr0_RQ0.shと同様の理由であんまりオススメできない．  
  
・RQ0solo.sh  
引数：メインプロジェクト名 サブプロジェクト名 レビュー番号 パッチ番号  
引数のレビュー番号のみ，引数のパッチ番号から現RQ1の調査を行う．  
そのレビュー番号の調査が終わったら終了する．  
主に不測の事態でエラー落ちした時に使う．   
  
・RQ0merge.sh  
引数：メインプロジェクト名 サブプロジェクト名  
前提：RQ0.shまたはRQ0part_retry.shが完了した後  
現RQ1の調査結果をサブプロジェクトごとにまとめる．  
  
・msr0_RQ0merge.sh  
引数：なし  
前提：RQ0merge.sh同様  
このpc上で担当するサブプロジェクト全てについてRQ0merge.shを一気にやってくれる．  
こっちのが便利なので基本RQ0merge.shはエラー落ちでもしない限り触れないでも問題ないはず．  
ちなみにAWSの担当のサブプロジェクトについてはこれは動かないので，  
代わりにmsr1_, msr2_, ...などと頭についてる方を使う．  
  
・RQ0fullmerge.sh  
引数：メインプロジェクト名  
前提：全サブプロジェクトでRQ0merge.shが完了した後  
現RQ1の調査結果をメインプロジェクトごとにまとめる．  
  
  
  
・RQ2.sh  
引数：メインプロジェクト名　サブプロジェクト名　（＋必要なら追加で始点のレビュー番号　終点のレビュー番号）  
前提：該当サブプロジェクトについてRQ0.shが終わっている  
サブプロジェクト単位でRQ2の調査を行う（SATDを含むレビューのみ）．  
  
・RQ2-2.sh  
引数：メインプロジェクト名　サブプロジェクト名　（＋必要なら追加で始点のレビュー番号　終点のレビュー番号）  
前提：該当サブプロジェクトについてRQ0.shが終わっている  
サブプロジェクト単位でRQ2の調査を行う（SATDを含まないレビューのみ）．   
  
・msr0_RQ2.sh  
引数：なし   
前提：RQ2.sh, RQ2-2.shと同様  
このpc上で担当するサブプロジェクト全てについてRQ2.sh, RQ2-2.shの内容を一気にやってくれる．  
  
・RQ2checker.sh  
引数：メインプロジェクト名　サブプロジェクト名   
前提：該当サブプロジェクトについてRQ2.sh, RQ2-2.shが終わっている  
サブプロジェクトごとに結果を保存する．  
  
・msr0_RQ2checker.sh  
引数：なし  
前提：RQ2checker.shと同様  
このpc上で担当するサブプロジェクトすべてについてRQ2checker.shにの内容を一気にやってくれる．  
  
・RQ2fullmerge.sh   
引数：メインプロジェクト名  
前提：全サブプロジェクトでRQ2checker.shが終わってる  
メインプロジェクトごとにRQ2の結果を出す．  
  
  
   
・RQ34.sh  
引数：メインプロジェクト名　サブプロジェクト名  
前提：RQ0.shが終わってる  
現RQ3の調査本体．  
  
・msr0_RQ34.sh  
引数：なし  
前提：RQ34.sh同様  
このpc上で担当するサブプロジェクト全てについてRQ34.shを一気にやってくれる．  
  
・RQ34merge.sh  
引数：メインプロジェクト名　サブプロジェクト名  
前提：RQ34.shが終わってる  
現RQ34の結果をサブプロジェクトごとに出す．  
  
・msr0_RQ34merge.sh  
引数：なし  
前提：RQ34merge.sh同様  
このpc上で担当するサブプロジェクト全てについてRQ34merge.shを一気にやってくれる．  
  
・RQ34fullmerge2.sh  
引数：メインプロジェクト名  
前提：全サブプロジェクトでRQ34merge.shが完了している  
メインプロジェクトごとに結果を出す．  
2と書いてあるのは1があったからではあるがそちらは使ってなさそうなので削除済  
  
・RQ34fullshuffhle.sh  
引数：メインプロジェクト名  
前提：RQ34fullmerge2.shが完了している  
コメントをランダムに並べ替える．目視調査の際に使う．  
  
  
  
・RQ5.sh  
引数：メインプロジェクト名　サブプロジェクト名  
前提：RQ34fullmerge2.shが完了している．  
現RQ4の調査本体．一応第３引数もあるが未使用だったはず．  
  
  
  
以下，セットアップ用ファイル（おそらく調査対象を広げない限りはもう使わない）   
  
・prepare.sh  
引数：メインプロジェクト名　終端のレビュー番号  
resultディレクトリにメインプロジェクト名のディレクトリ，さらにその中に  
第二引数のレビュー番号のとこまで必要な分だけディレクトリを用意する．  
基本的に既にディレクトリが用意されてる場合は使わない．  
  
・review.sh  
引数：メインプロジェクト名  
どのレビュー番号がどのサブプロジェクトのものなのかの情報を取る．  
  
・merge_v2.sh  
引数：メインプロジェクト名  
実行のたびに中身を適宜書き換える必要あり．  
上記のreview.shをエラーなどの原因で分割して実行させていた場合はこのプログラムを利用してデータを結合する．  
  
＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿＿
  
  
・key_pair.pem.txt  
AWSにアクセスするときとかに使う．なぜか.txtをつけないとうまく動作しなかったが原因不明．  
  


